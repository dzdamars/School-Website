/*!
 * froala_editor v2.5.1 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2017 Froala Labs
 */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c)}:a(window.jQuery)}(function(a){a.extend(a.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color"]}),a.FE.PLUGINS.wordPaste=function(b){function c(){b.events.on("paste.beforeCleanup",function(a){return b.paste.isWord(a)&&(a=a.replace(/^\n*/g,"").replace(/^ /g,""),0===a.indexOf("<colgroup>")&&(a="<table>"+a+"</table>"),a=w(a,b.paste.getRtfClipboard()),a=b.paste.removeEmptyTags(a)),a})}function d(a){var b=a.parentNode;b&&a.parentNode.removeChild(a)}function e(a,b){if(b(a))for(var c=a.firstChild;c;){var d=c,f=c.previousSibling;c=c.nextSibling,e(d,b),d.previousSibling||d.nextSibling||d.parentNode||!c||f==c.previousSibling||!c.parentNode?d.previousSibling||d.nextSibling||d.parentNode||!c||c.previousSibling||c.nextSibling||c.parentNode||(f?c=f.nextSibling?f.nextSibling.nextSibling:null:a.firstChild&&(c=a.firstChild.nextSibling)):c=f?f.nextSibling:a.firstChild}}function f(a){return a.nodeType==Node.ELEMENT_NODE&&a.getAttribute("style")&&a.getAttribute("style").replace(/\n/gi,"").indexOf("mso-list:Ignore")!=-1}function g(a){if(!a.getAttribute("style")||!/mso-list:[\s]*l/gi.test(a.getAttribute("style").replace(/\n/gi,"")))return!1;try{var b=a.firstElementChild.firstElementChild,c=b.firstElementChild?b.firstElementChild:null;if(!f(b)&&!f(c))return!1}catch(d){return!1}return!0}function h(a){return a.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function i(a,b){var c=a.cloneNode(!0);if(c.firstElementChild&&"A"==c.firstElementChild.tagName&&(c=c.firstElementChild),d(c.firstElementChild),["H1","H2","H3","H4","H5","H6"].indexOf(a.tagName)!=-1){var f=document.createElement(a.tagName.toLowerCase());f.setAttribute("style",a.getAttribute("style")),f.innerHTML=c.innerHTML,c.innerHTML=f.outerHTML}e(c,function(a){return a.nodeType==Node.ELEMENT_NODE&&u(a,null,b),!0});var g=c.innerHTML;return g=g.replace(/<!--[\s\S]*?-->/gi,"")}function j(a,b){var c=/[0-9a-zA-Z]./gi,e=!1;a.firstElementChild&&a.firstElementChild.firstElementChild&&a.firstElementChild.firstElementChild.firstChild&&(e=e||c.test(a.firstElementChild.firstElementChild.firstChild.data),!e&&a.firstElementChild.firstElementChild.firstElementChild&&a.firstElementChild.firstElementChild.firstElementChild.firstChild&&(e=e||c.test(a.firstElementChild.firstElementChild.firstElementChild.firstChild.data)));var f=e?"ol":"ul",k=h(a),l="<"+f+"><li>"+i(a,b),m=a.nextElementSibling,n=a.parentNode;for(d(a),a=null;m&&g(m);){var o=m.previousElementSibling,p=h(m);if(p>k)l+=j(m,b).outerHTML;else{if(p<k)break;l+="</li><li>"+i(m,b)}if(k=p,m.previousElementSibling||m.nextElementSibling||m.parentNode){var q=m;m=m.nextElementSibling,d(q),q=null}else m=o?o.nextElementSibling:n.firstElementChild}l+="</li></"+f+">";var r=document.createElement("div");r.innerHTML=l;var s=r.firstElementChild;return s}function k(a,b){for(var c=document.createElement(b),d=0;d<a.attributes.length;d++){var e=a.attributes[d].name;c.setAttribute(e,a.getAttribute(e))}return c.innerHTML=a.innerHTML,a.parentNode.replaceChild(c,a),c}function l(a){var b=null;if(a.firstElementChild&&(b=a.firstElementChild.tagName,["SPAN","STRONG","B","S","EM","U","SUB","SUP"].indexOf(b)!=-1)){if("TD"!=a.tagName)for(var c=a.firstElementChild;c;){if("SPAN"==c.tagName){p(c,a.getAttribute("style"));break}c=c.firstElementChild}}else if("DIV"!=b){var d=a.getAttribute("style"),e=document.createElement("span");d&&(d=o(d),e.setAttribute("style",d)),e.innerHTML=a.innerHTML,a.innerHTML=e.outerHTML}}function m(c,e){b.node.clearAttributes(c);for(var f=c.firstElementChild,h=0,i=!1,j=null;f;){f.firstElementChild&&f.firstElementChild.tagName.indexOf("W:")!=-1&&(f.innerHTML=f.firstElementChild.innerHTML),j=f.getAttribute("width"),j||i||(i=!0),h+=parseInt(j,10),(!f.firstChild||f.firstChild&&f.firstChild.data==a.FE.UNICODE_NBSP)&&(f.firstChild&&d(f.firstChild),f.innerHTML="<br>");for(var m=f.firstElementChild,q=1==f.children.length;m;){if("P"==m.tagName&&!g(m)){var s=null;1==m.children.length&&m.firstElementChild&&"SPAN"==m.firstElementChild.tagName?(s=m.firstElementChild,q||(s=k(s,"div")),q?p(f,m.getAttribute("style")):p(s,m.getAttribute("style")),f.replaceChild(s,m)):(s=k(m,q?"span":"div"),!q&&s.getAttribute("align")&&s.removeAttribute("align")),m=s,q&&n(m)}m=m.nextElementSibling}if(e){var t=f.getAttribute("class");if(t){t=o(t);var u=t.match(/xl[0-9]+/gi);if(u){var v=u[0],w="."+v;e[w]&&p(f,e[w])}}e.td&&p(f,e.td),l(f),r(f)}var x=f.getAttribute("style");x&&(x=o(x),x&&";"!=x.slice(-1)&&(x+=";"));var y=f.getAttribute("valign");if(!y&&x){var z=x.match(/vertical-align:.+?[; "]{1,1}/gi);z&&(y=z[z.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var A=null;if(x){var B=x.match(/text-align:.+?[; "]{1,1}/gi);B&&(A=B[B.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==A&&(A=null)}var C=null;if(x){var D=x.match(/background:.+?[; "]{1,1}/gi);D&&(C=D[D.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var E=f.getAttribute("colspan");b.node.clearAttributes(f),E&&f.setAttribute("colspan",E),y&&(f.style["vertical-align"]=y),A&&(f.style["text-align"]=A),C&&(f.style["background-color"]=C),j&&f.setAttribute("width",j),f=f.nextElementSibling}for(f=c.firstElementChild;f;)j=f.getAttribute("width"),i?f.removeAttribute("width"):f.setAttribute("width",100*parseInt(j,10)/h+"%"),f=f.nextElementSibling}function n(a){var b=a.parentNode,c=a.getAttribute("align");c&&(b&&"TD"==b.tagName?(b.setAttribute("style",b.getAttribute("style")+"text-align:"+c+";"),a.removeAttribute("align")):(a.style["text-align"]=c,a.removeAttribute("align")))}function o(a){return a.replace(/\n|\r|\n\r|&quot;/g,"")}function p(a,b,c){if(b){var d=a.getAttribute("style");d&&";"!=d.slice(-1)&&(d+=";"),b&&";"!=b.slice(-1)&&(b+=";"),b=b.replace(/\n/gi,"");var e=null;e=c?(d||"")+b:b+(d||""),a.setAttribute("style",e)}}function q(a){var b=a.getAttribute("style");if(b){b=o(b),b&&";"!=b.slice(-1)&&(b+=";");var c=b.match(/(^|\S+?):.+?;{1,1}/gi);if(c){for(var d={},e=0;e<c.length;e++){var f=c[e],g=f.split(":");2==g.length&&("text-align"==g[0]&&"SPAN"==a.tagName||(d[g[0]]=g[1]))}var h="";for(var i in d)if(d.hasOwnProperty(i)){if("font-size"==i&&"pt;"==d[i].slice(-3)){var j=null;try{j=parseFloat(d[i].slice(0,-3),10)}catch(k){}j&&(j=Math.round(1.33*j),d[i]=j+"px;")}h+=i+":"+d[i]}h&&a.setAttribute("style",h)}}}function r(a){var b=a.getAttribute("style");if(b){b=o(b);var c=b.match(/(^|;)font-weight:.+?[; "]{1,1}/gi),d=null;if(c&&(d=c[c.length-1].replace(/(^|;)font-weight:(.+?)[; "]{1,1}/gi,"$2")),d&&(d>=700||"bold"==d)){var e=document.createElement("strong");e.innerHTML=a.innerHTML,a.innerHTML=e.outerHTML}}}function s(a){for(var b=a.match(/[0-9a-f]{2}/gi),c=[],d=0;d<b.length;d++)c.push(String.fromCharCode(parseInt(b[d],16)));var e=c.join("");return btoa(e)}function t(a,b){if(b){var c=a.getAttribute("src");if(c&&c.indexOf("file://")!=-1){var d=a.getAttribute("v:shapes");if(d){if(d.indexOf("Picture")!=-1&&a.previousSibling){var e=a.previousSibling.previousSibling;if(!e)return;var f=e.data.split('o:spid="');if(2!=f.length)return;if(f=f[1].split('"'),f.length<2)return;d=f[0]}var g="hplid"+d.substring(8),h=b.split(g);if(!h||2==h.length){var i=h[1].split("bliptag");if(!(i&&i.length<2)){var j=null;if(i[0].indexOf("pngblip")!=-1?j="image/png":i[0].indexOf("jpegblip")!=-1&&(j="image/jpeg"),j){var k=i[1].split("}");if(!(k&&k.length<2)){var l;if(k.length>2&&k[0].indexOf("blipuid")!=-1)l=k[1].split(" ");else{if(l=k[0].split(" "),l&&l.length<2)return;l.shift()}var m=l.join(""),n=s(m),o="data:"+j+";base64,"+n;a.setAttribute("src",o)}}}}}}}}function u(c,e){var f=c.tagName,g=f.toLowerCase();c.firstElementChild&&("I"==c.firstElementChild.tagName?k(c.firstElementChild,"em"):"B"==c.firstElementChild.tagName&&k(c.firstElementChild,"strong"));var h=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"];if(h.indexOf(f)!=-1)return d(c),!1;"O:P"==f&&"&nbsp;"==c.innerHTML&&(c.innerHTML=a.FE.INVISIBLE_SPACE);var i=-1,j=["META","LINK","XML","ST1:","O:","W:","FONT"];for(i=0;i<j.length;i++)if(f.indexOf(j[i])!=-1)return c.innerHTML?(c.outerHTML=c.innerHTML,d(c),!1):(d(c),!1);if("TD"!=f){var q=c.getAttribute("class");if(e&&q){q=o(q);var s=q.split(" ");for(i=0;i<s.length;i++){var t=s[i],u=[],v="."+t;u.push(v),v=g+v,u.push(v);for(var w=0;w<u.length;w++)e[u[w]]&&p(c,e[u[w]])}}e&&e[g]&&p(c,e[g])}var x=["P","H1","H2","H3","H4","H5","H6","PRE"];if(x.indexOf(f)!=-1){l(c),r(c);var y=c.getAttribute("style"),z=null;if(y){var A=y.match(/text-align:.+?[; "]{1,1}/gi);A&&(z=A[A.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1"))}z?c.setAttribute("style",z):c.removeAttribute("style")}if("P"==f&&n(c),"TR"==f&&m(c,e),c.getAttribute("class")&&c.getAttribute("class").toLowerCase().indexOf("mso")!=-1){var B=o(c.getAttribute("class"));B=B.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""),B?c.setAttribute("class",B):c.removeAttribute("class")}if("A"==f&&!c.attributes.getNamedItem("href")&&c.innerHTML&&(c.outerHTML=c.innerHTML),"TD"!=f&&"TH"!=f||c.innerHTML||(c.innerHTML="<br>"),"TABLE"==f&&(b.node.clearAttributes(c),c.setAttribute("style","width: 100%;")),c.getAttribute("lang")&&c.removeAttribute("lang"),c.getAttribute("style")&&c.getAttribute("style").toLowerCase().indexOf("mso")!=-1){var C=o(c.getAttribute("style"));C=C.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""),C?c.setAttribute("style",C):c.removeAttribute("style")}return!0}function v(a){var b={},c=a.getElementsByTagName("style");if(c.length){var d=c[0],e=d.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(e)for(var f=0;f<e.length;f++){var g=e[f],h=g.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),i=g.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");h=h.replace(/^[\s]|[\s]$/gm,""),i=i.replace(/^[\s]|[\s]$/gm,""),h=h.replace(/\n|\r|\n\r/g,""),i=i.replace(/\n|\r|\n\r/g,"");for(var j=h.split(", "),k=0;k<j.length;k++)b[j[k]]=i}}return b}function w(c,f){c=c.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/gi,"$1");var h=new DOMParser,i=h.parseFromString(c,"text/html"),k=i.head,l=i.body,m=v(k);e(l,function(b){if(b.nodeType==Node.TEXT_NODE&&/\n/.test(b.data)){if(!/\S/.test(b.data))return b.data==a.FE.UNICODE_NBSP||(d(b),!1);b.data=b.data.replace(/\n/gi," ")}return!0}),e(l,function(a){return a.nodeType==Node.ELEMENT_NODE&&"IMG"==a.tagName&&t(a,f),!0}),e(l,function(a){if(a.nodeType==Node.TEXT_NODE)return a.data=a.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(a.nodeType==Node.ELEMENT_NODE){if(g(a)){var b=a.parentNode,c=a.previousSibling,e=j(a,f),h=null;return h=c?c.nextSibling:b.firstChild,h?b.insertBefore(e,h):b.appendChild(e),!1}return u(a,m,f)}return a.nodeType!=Node.COMMENT_NODE||(d(a),!1)}),e(l,function(a){if(a.nodeType==Node.ELEMENT_NODE){var b=a.tagName;if(!a.innerHTML&&["BR","IMG"].indexOf(b)==-1){for(var c=a.parentNode;c&&(d(a),a=c,!a.innerHTML);)c=a.parentNode;return!1}q(a)}return!0});var n=l.outerHTML,o=b.opts.htmlAllowedStyleProps;return b.opts.htmlAllowedStyleProps=b.opts.wordAllowedStyleProps,n=b.clean.html(n,b.opts.wordDeniedTags,b.opts.wordDeniedAttrs,!1),b.opts.htmlAllowedStyleProps=o,n}return{_init:c}}});